@model Promocodoz.Web.ViewModel.ConsoleViewModel
@{
    ViewBag.Title = "Console";
}

<h2>@ViewBag.Title</h2>

<div>
    <hr />
    <h4>API Credentials</h4>
    <dl class="dl-horizontal">
        <dt>Account SID:</dt>
        <dd>@Model.AccountInfo.Sid</dd>
        <dt>Secret Key:</dt>
        <dd>@Model.AccountInfo.Secret</dd>
    </dl>
</div>
<div>
    <hr />
    <h4>Promo Codes</h4>
    <div>
        @using (Html.BeginForm("GenerateCodes", "Console", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
        {
            @Html.AntiForgeryToken()
            @Html.ValidationSummary("", new { @class = "text-danger" })

            <div class="form-group">
                <label class="col-md-2 control-label">Count of codes:</label>
                <div class="col-md-10">
                    <input type="number" class="form-control" name="count" min="1" max="100" value="1" required />
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">Value:</label>
                <div class="col-md-10">
                    <input type="number" class="form-control" name="value" value="1" required />
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">Platform:</label>
                <div class="col-md-10">
                    <select class="form-control" name="platform">
                        <option>All</option>
                        @foreach (var platform in ViewBag.Platforms)
                        {
                            <option value="@platform">@platform.ToString()</option>
                        }
                    </select>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" class="btn btn-primary" id="btn-loading" data-loading-text="Generating..." value="Generate" />
                </div>
            </div>
        }

        <table class="table-bootstrap" data-search="true">
            <thead>
                <tr>
                    <th>Code</th>
                    <th data-sortable="true">Value</th>
                    <th data-sortable="true">Platform</th>
                    <th data-sortable="true">Is Activated</th>
                    <th data-sortable="true">Activation Date</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var code in Model.Codes)
                {
                    <tr class="@{ Write(code.IsActivated ? "success" : string.Empty); }">
                        <td>@code.Key</td>
                        <td>@code.Value</td>
                        <td>@{ Write(code.Platform?.ToString() ?? "All"); }</td>
                        <td>@{ Write(code.IsActivated ? "Yes" : "No"); }</td>
                        <td>@{ Write(code.ActivationDate?.ToShortDateString() ?? string.Empty); }</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>